import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.util.PropertiesUtil;

public class TestLog4jVulnerability {
    static Logger logger = LogManager.getLogger();
    public static void main(String[] args) {
        System.out.println("Main says, 'Checking log4jVulnerability'");
        logger.error("${java:version}/${java:os}");
        System.out.println("LOG4J_FORMAT_MSG_NO_LOOKUPS=" + System.getProperty("LOG4J_FORMAT_MSG_NO_LOOKUPS"));
        boolean flag = PropertiesUtil.getProperties().getBooleanProperty("log4j2.formatMsgNoLookups");
        System.out.println("log4j2.formatMsgNoLookups=" + flag);
        if(flag)
            System.out.println("log4j is Non-Vulnerable");
        else
            System.out.println("******** log4j is Vulnerable ********");
        System.out.println("Main is exiting.");

    }
}
